<!DOCTYPE html>
<html><head><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta charset="utf-8"><title>Demo C — Grid & FOV</title>
<style>
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:#fff;color:#000;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial}
.page{max-width:100%;margin:0 auto;min-height:100vh;border:2px solid #000;display:flex;flex-direction:column}
.header{padding:12px 16px;border-bottom:2px solid #000}
.title{font-size:32px;font-weight:800}
.content{padding:16px;display:flex;flex-direction:column;gap:12px}
.controls label{display:inline-block;min-width:100%}
.controls input,.controls select{font-size:18px}
canvas{width:100%;height:min(70vh, 820px);min-height:auto;border:2px solid #000;background:#fff;display:block}
#log{white-space:pre-wrap;font-family:ui-monospace,Menlo,Consolas,monospace;border:1px dashed #000;padding:8px;background:#fafafa}
a.nav{display:inline-block;margin:12px 16px 16px 16px;border:2px solid #000;padding:8px 12px;color:#000;text-decoration:none;font-weight:700;align-self:flex-start;background:#fff}

:root{
  --maxw: 1200px;
  --pad: clamp(12px, 2.2vw, 24px);
  --fs-body: clamp(16px, 2.0vw, 28px);
  --fs-title: clamp(22px, 3.2vw, 40px);
  --fs-caption: clamp(14px, 1.6vw, 22px);
}
html, body { height:100%; margin:0; background:#fff; color:#000; }
.page{
  max-width: var(--maxw);
  width: min(100%, var(--maxw));
  margin: 0 auto;
  min-height: 100svh;
  border: 2px solid #000;
  display: flex;
  flex-direction: column;
}
.header{ padding: var(--pad); border-bottom:2px solid #000; }
.title{ font-size: var(--fs-title); font-weight: 800; }
.content{
  padding: var(--pad);
  display:flex; flex-direction:column; gap: clamp(10px,1.5vw,20px);
  font-size: var(--fs-body); line-height:1.5;
}
.slide-img{
  display:block; max-width:100%; height:auto;
  margin: clamp(8px,1.2vw,16px) auto; border:2px solid #000;
}
.figure{ margin:0; }
.caption{ font-size: var(--fs-caption); text-align:center; margin:8px auto 12px; }
.caption span{ display:inline-block; padding:2px 6px; border:1px solid #000; background:#f7f7f7; }
pre{
  background:#f5f5f5; border:1px solid #000;
  padding: clamp(8px,1.5vw,16px);
  white-space: pre-wrap; overflow:auto;
  font-size: clamp(14px,1.8vw,22px);
}
code{ font-size: clamp(14px,1.8vw,22px); }
.nav-prev, .nav-next{
  position: fixed; bottom: clamp(10px, 2vh, 20px);
  padding: clamp(8px,1vw,12px) clamp(10px,1.2vw,14px);
  border:2px solid #000; background:#fff; color:#000; text-decoration:none; font-weight:700; z-index:10;
}
.nav-prev{ left: clamp(10px, 2vw, 24px); }
.nav-next{ right: clamp(10px, 2vw, 24px); }
.footer-spacer{ height: clamp(48px, 8vh, 80px); }
@media (max-width:100%){ .header,.content{ padding:12px; } }


.nav-center{
  position: fixed; bottom: clamp(10px, 2vh, 20px);
  left: 50%; transform: translateX(-50%);
  padding: clamp(8px,1vw,12px) clamp(12px,1.6vw,16px);
  border: 2px solid #000; background:#fff; color:#000;
  font-weight:700; z-index:10; white-space:nowrap;
}
.nav-center a{ color:#000; text-decoration:none; }
.nav-center a + a{ margin-left: 12px; }

</style></head>
<body>
<div class="page">
  <div class="header"><div class="title">Demo C — Ground Grid &amp; FOV</div></div>
  <div class="content">
    <div class="controls">
      <label>fov°</label><input id="fov" type="range" min="20" max="120" step="1" value="60">
    </div>
    <canvas id="gl"></canvas>
    <pre id="log"></pre>
  </div>
  <a class="nav" href="index.html">Back</a>
</div>
<script>
// Column-major 4x4 matrices (OpenGL/WebGL): m[col*4 + row]
const Mat4 = {
  identity: () => [1,0,0,0, 0,1,0,0, 0,0,1,0, 0,0,0,1],
  multiply: (a,b) => {
    const out = new Array(16);
    for (let c=0;c<4;c++) for (let r=0;r<4;r++)
      out[c*4+r] = a[0*4+r]*b[c*4+0] + a[1*4+r]*b[c*4+1] + a[2*4+r]*b[c*4+2] + a[3*4+r]*b[c*4+3];
    return out;
  },
  translate: (m,[x,y,z]) => Mat4.multiply(m,[1,0,0,0, 0,1,0,0, 0,0,1,0, x,y,z,1]),
  scale: (m,[x,y,z]) => Mat4.multiply(m,[x,0,0,0, 0,y,0,0, 0,0,z,0, 0,0,0,1]),
  rotateX: (m,a) => { const c=Math.cos(a),s=Math.sin(a); return Mat4.multiply(m,[1,0,0,0, 0,c,s,0, 0,-s,c,0, 0,0,0,1]); },
  rotateY: (m,a) => { const c=Math.cos(a),s=Math.sin(a); return Mat4.multiply(m,[c,0,-s,0, 0,1,0,0, s,0,c,0, 0,0,0,1]); },
  rotateZ: (m,a) => { const c=Math.cos(a),s=Math.sin(a); return Mat4.multiply(m,[c,s,0,0, -s,c,0,0, 0,0,1,0, 0,0,0,1]); },
  perspective: (fovy, aspect, near, far) => {
    const f = 1/Math.tan(fovy/2), nf = 1/(near - far);
    return [f/aspect,0,0,0, 0,f,0,0, 0,0,(far+near)*nf,-1, 0,0,(2*far*near)*nf,0];
  },
  lookAt: (eye,center,up) => {
    let [ex,ey,ez]=eye,[cx,cy,cz]=center,[ux,uy,uz]=up;
    let zx=ex-cx, zy=ey-cy, zz=ez-cz; const zlen=Math.hypot(zx,zy,zz); zx/=zlen; zy/=zlen; zz/=zlen;
    let xx=uy*zz-uz*zy, xy=uz*zx-ux*zz, xz=ux*zy-uy*zx; const xlen=Math.hypot(xx,xy,xz); xx/=xlen; xy/=xlen; xz/=xlen;
    let yx=zy*xz-zz*xy, yy=zz*xx-zx*xz, yz=zx*xy-zy*xx;
    return [xx,yx,zx,0,  xy,yy,zy,0,  xz,yz,zz,0,  -(xx*ex+xy*ey+xz*ez), -(yx*ex+yy*ey+yz*ez), -(zx*ex+zy*ey+zz*ez), 1];
  }
};
function resizeCanvasToDisplaySize(canvas){
  const dpr = window.devicePixelRatio || 1;
  const w = Math.max(1, Math.floor(canvas.clientWidth * dpr));
  const h = Math.max(1, Math.floor(canvas.clientHeight * dpr));
  if (canvas.width !== w || canvas.height !== h) { canvas.width=w; canvas.height=h; }
}
function glerr(gl, label){
  const e = gl.getError(); if (e!==gl.NO_ERROR) console.warn(label, e);
}
</script>
<script>
(function(){
  const log = document.getElementById('log');
  const canvas=document.getElementById('gl');
  const gl=canvas.getContext('webgl'); if(!gl){ log.textContent='WebGL not supported'; return; }
  function comp(t,src){ const s=gl.createShader(t); gl.shaderSource(s,src); gl.compileShader(s); if(!gl.getShaderParameter(s,gl.COMPILE_STATUS)) throw new Error(gl.getShaderInfoLog(s)); return s; }
  function prog(vs,fs){ const p=gl.createProgram(); gl.attachShader(p,comp(gl.VERTEX_SHADER,vs)); gl.attachShader(p,comp(gl.FRAGMENT_SHADER,fs)); gl.linkProgram(p); if(!gl.getProgramParameter(p,gl.LINK_STATUS)) throw new Error(gl.getProgramInfoLog(p)); return p; }
  const VS='attribute vec3 aPosition; uniform mat4 uMVP; void main(){ gl_Position=uMVP*vec4(aPosition,1.0);}';
  const FS='precision mediump float; void main(){ gl_FragColor=vec4(0,0,0,1);}';
  let p; try{ p=prog(VS,FS);} catch(e){ log.textContent=e.toString(); return;}
  gl.useProgram(p);
  const pts=[]; for(let i=-20;i<=20;i++){ pts.push(-20,0,i, 20,0,i,  i,0,-20,  i,0,20); }
  const v=new Float32Array(pts);
  const vbo=gl.createBuffer(); gl.bindBuffer(gl.ARRAY_BUFFER,vbo); gl.bufferData(gl.ARRAY_BUFFER,v,gl.STATIC_DRAW);
  const a=gl.getAttribLocation(p,'aPosition'); gl.enableVertexAttribArray(a); gl.vertexAttribPointer(a,3,gl.FLOAT,false,0,0);
  const u=gl.getUniformLocation(p,'uMVP');
  gl.clearColor(1,1,1,1);
  function render(){
    resizeCanvasToDisplaySize(canvas);
    const fov=+document.getElementById('fov').value * Math.PI/180;
    const V=Mat4.lookAt([8,6,12],[0,0,0],[0,1,0]);
    const P=Mat4.perspective(fov, canvas.width/canvas.height, 0.1, 200);
    const MVP=Mat4.multiply(Mat4.multiply(P,V), Mat4.identity());
    gl.viewport(0,0,canvas.width,canvas.height);
    gl.clear(gl.COLOR_BUFFER_BIT);
    gl.uniformMatrix4fv(u,false,new Float32Array(MVP));
    gl.drawArrays(gl.LINES, 0, v.length/3);
  }
  document.getElementById('fov').addEventListener('input', render);
  window.addEventListener('resize', render);
  render();
})();
</script>
<div class="nav-center"><a href="index.html">Home</a> · <a href="demos/index.html">Demos</a></div>
</body></html>
